
If scada.exe finds a matching DLL file name, it kills all running processes with the name biogas.exe .
The malware then moves Step7ProSim.dll to Step7ConMgr.dll and drops a malicious Step7ProSim.dll – the IRONGATE payload – to the same directory.
The malicious Step7ProSim.dll acts as an API proxy between the original user-created Step7ProSim.dll (now named Step7ConMgr.dll ) and the application biogas.exe that loads it.
Five seconds after loading, the malicious Step7ProSim.dll records five seconds of calls to ReadDataBlockValue .
All future calls to ReadDataBlockValue return the recorded data.
Simultaneously, the malicious DLL discards all calls to WriteDataBlockValue
and instead calls WriteInputPoint(0x110, 0, 0x7763) and WriteInputPoint(0x114, 0, 0x7763) every millisecond.
All of these functions are named similarly to Siemens S7ProSim v5.4 COM interface.
It appears that other calls to API functions are passed through the malicious DLL to the legitimate DLL with no other modification.
Biogas.exe As mentioned previously, IRONGATE seeks to manipulate code similar to that found on a blog dealing with simulating PLC communications using PLCSIM, including the use of an executable named biogas.exe .