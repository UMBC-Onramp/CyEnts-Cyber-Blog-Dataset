
We observed that just by hovering over a file, the full path or content of the file would be displayed.
What happens if we were to click on it?
That depends on the target.
If the file being opened is an application or an executable (such as notepad or calc.exe), the file will run and be accessible only after the user properly logs in.
If it is a document, script, or text file, it will be opened by an editor instead of being executed.
At this point we can execute various preloaded Windows utilities such as calculator, but we cannot pass any parameters to the command line.
We can open scripts including PowerShell, but instead of being executed, they will be opened in a text editor (notepad).
The lack of parameters is a limitation for a “live off the land” attack, which uses current tools and content to achieve a malicious purpose; however, there are plenty of malicious activities that could be performed even with these restrictions.
For example, many uninstallers will happily remove software without any need for parameters.
Let’s return to our goal: code execution from the lock screen.
The only requirement for something to show up in the contextual menu is for it to be indexed.
Public folders indexed by default.
There are multiple ways for an unauthenticated attacker to get results to show up in the index of an authenticated user.