
18184174 57              push    edi 18184175 81ece0050000    sub     esp,5E0h 1818417b c7042410000100  mov     dword ptr [esp],10010h 18184182 8d7c2404        lea     edi,[esp+4] 18184186 b9dc050000      mov     ecx,5DCh 1818418b 33c0            xor     eax,eax 1818418d f3aa            rep stos byte ptr es:[edi] 1818418f 54              push    esp 18184190
6afe            push    0FFFFFFFEh 18184192
b8b308b476      mov     eax,offset kernel32!SetThreadContext (76b408b3) 18184197 ffd0            call    eax The shellcode calls URLDownloadToCacheFileA to download the next stage of the payload, disguised as an image.
Mitigation Using EMET may break the exploit in your environment and prevent it from successfully controlling your computer.
EMET versions 4.1 and 5.0 break (and/or detect) the exploit in our tests.
Enhanced Protected Mode in IE breaks the exploit in our tests.
EPM was introduced in IE10.
Additionally, the attack will not work without Adobe Flash.
Disabling the Flash plugin within IE will prevent the exploit from functioning.
Threat Group History
The APT group responsible for this exploit has been the first group to have access to a select number of browser-based 0-day exploits (e.g. IE, Firefox, and Flash) in the past.
They are extremely proficient at lateral movement and are difficult to track, as they typically do not reuse command and control infrastructure.
They have a number of backdoors including one known as Pirpi that we previously discussed here .
CVE-2010-3962, then a 0-day exploit in Internet Explorer 6, 7, and 8 dropped the Pirpi payload discussed in this previous case.
As this is still an active investigation we are not releasing further indicators about the exploit at this time.
Acknowledgement:
We thank Christopher Glyer, Matt Fowler, Josh Homan, Ned Moran, Nart Villeneuve and Yichong Lin for their support, research, and analysis on these findings.
Subscribe to Blogs Get email updates as new blog posts are added.


