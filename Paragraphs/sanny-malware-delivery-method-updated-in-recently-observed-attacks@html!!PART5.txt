
The malicious BAT file is stored as the contents of a fake PEM encoded SSL certificate (with the BEGIN and END markers) on the Stage 1 URL, as shown in Figure 3.
 The “certutil.exe” utility is then leveraged to both strip the BEGIN/END markers and decode the Base64 contents of the file.
FireEye has not previously observed the malware authors use this technique in past campaigns.
Figure 3: