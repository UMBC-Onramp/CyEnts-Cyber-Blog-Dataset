
It also searches for SetThreadContext in kernel32, which is used to clear the debug registers.
This technique, may be an attempt to bypass protections that use hardware breakpoints, such as EMET’s EAF mitigation.
With the addresses of the aforementioned APIs and gadget, the SWF file constructs a ROP chain, and prepends it to its RC4 decrypted shellcode.
It then replaces the vftable of a sound object with a fake one that points to the newly created ROP payload.
When the sound object attempts to call into its vftable, it instead pivots control to the attacker’s ROP chain.