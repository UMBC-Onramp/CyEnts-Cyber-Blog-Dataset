
The APIs contain VirtualAlloc(), memset(), and CreateThread().
Figure 9 shows the decoded Base64 code.
Figure 9: Base64 decoded Pause.ps1
The injected code is responsible for downloading the final payload from the server (see Figure 10).
The final stage payload is a PE executable compiled with .Net framework.
Figure 10:
Network traffic to download final payload (words.exe) Once executed, the file performs the following activities: Drops a copy of itself in %AppData%\\svchost.exe\\svchost.exe and drops an XML file, which contains configuration information for Task Scheduler (as shown in Figure 11).