
The dropper iterates through each entry in scxrt2.ini , looking for paths named move-to-operational or move-to-operational.lnk .
If a path is found, the dropper first extracts the Base64-encoded .NET executable scada.exe to the current directory and then moves the file to the path containing move-to-operational or move-to-operational.lnk.
The path move-to-operational is interesting as well, perhaps implying that IRONGATE was not seeking the actual running process, but rather a staging area for code promotion.
The dropper does not execute the scada.exe payload after moving it.
Anti-Analysis Techniques
Each IRONGATE dropper currently identified deploys the same .NET payload, scada.exe.
All but one of the droppers incorporated anti-detection/analysis techniques to identify execution in VMware or the Cuckoo Sandbox.
If such environments are detected, the dropper will not deploy the .NET executable ( scada.exe ) to the host.
Four of the droppers ( update.exe 1 , update_no_pipe.exe 1 , update_no_pipe.exe 2 , and update.exe 3 ) detect Cuckoo environments by scanning subdirectories of the %SystemDrive% .
Directories with names greater than five, but fewer than ten characters are inspected for the subdirectories drop, files, logs, memory, and shots.
If a matching directory is found, the dropper does not attempt to deploy the scada.exe payload.
The update.exe 1 and update.exe 3 droppers contain code for an additional Cuckoo check using the SysInternals pipelist program, install.exe , but the code is disabled in each.