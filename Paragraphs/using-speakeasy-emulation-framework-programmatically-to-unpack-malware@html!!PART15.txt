
After examining the Speakeasy API log shown in Figure 9, such a location was easy to spot.
The graphics-related API function GetDeviceCaps is invoked early in the MFC initialization routine.
This was deduced based on 1) MFC is a graphics-dependent framework and 2)
GetDeviceCaps is unlikely to be called during C-runtime initialization.
0x43e0a7: 'kernel32.FlsGetValue(0x0)' -> 0x4150 0x43e0e3: 'kernel32.DecodePointer(0x7049)' ->
0x7048 0x43b16a: 'KERNEL32.HeapSize(0x4130, 0x0, 0x7000)' -> 0x90 0x43e013: 'KERNEL32.TlsGetValue(0x0)' -> 0xfeee0001
0x43e02a: 'KERNEL32.TlsGetValue(0x0)' -> 0xfeee0001
0x43e02c: 'kernel32.FlsGetValue(0x0)' -> 0x4150 0x43e068: 'kernel32.EncodePointer(0x44e215)' -> 0x44e216 0x43e013: 'KERNEL32.TlsGetValue(0x0)' -> 0xfeee0001 0x43e02a: 'KERNEL32.TlsGetValue(0x0)' -> 0xfeee0001