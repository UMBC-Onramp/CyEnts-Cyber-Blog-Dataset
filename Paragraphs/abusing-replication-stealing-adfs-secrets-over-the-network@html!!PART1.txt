Organizations are increasingly adopting cloud-based services such as Microsoft 365 to host applications and data.
Sophisticated threat actors are catching on and Mandiant has observed an increased focus on long-term persistent access to Microsoft 365 as one of their primary objectives.
The focus on developing novel and hard to detect methods to achieve this goal was highlighted with the recent detection of UNC2452 and their access to Microsoft 365 .
One of this group's key TTPs was to steal the Token Signing Certificate from an organizationâ€™s AD FS server to enable them to bypass MFA and access cloud services as any user, at any time.
While defenders previously associated the defense of this certificate, and thus the entire ecosystem, with careful access control and detection efforts around the AD FS server and service account, this is no longer sufficient.
In this blog post we will show how a threat actor, with the right privilege, can extract the encrypted Token Signing Certificate from anywhere on the internal network.