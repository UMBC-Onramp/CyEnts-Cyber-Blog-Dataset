
Click “Run with PowerShell” “Run with PowerShell” right-click menu option for Recent items.
We now have local code execution with the payload of our choosing, without any exploit, even if the device is encrypted, on an up-to-date locked Windows 10 device.
This technique helps us understand some of the differences between apps, documents, extensions, and the way Windows handles them from a locked or unlocked screen.
Yet it probably does not represent much of a real-world attack vector.
Then again, we are not finished.
Logging into a Locked Device with no User Interaction Finally, we have local code execution, but with some real limitations.
We need to get our payload indexed but we cannot pass command-line parameters.
This could be a limiting factor for our PowerShell attack vector because the execution policy may prevent its execution, and without command-line parameters we cannot pass
an “-ExecutionPolicy Bypass” (or any other flavor).
We would also have to find a way to land a PS1 script on the victim’s box, and have remote access to the physical machine or the login screen.