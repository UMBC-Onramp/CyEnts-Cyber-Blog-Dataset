
Deep technical analysis During our research, we came across many code similarities between North Korean binaries that had not been seen before.
Some of these attacks and malware have not been linked to one another, at least publicly.
We will showcase four examples of reused code that has been seen only in malware attributed to North Korea.
Common SMB module The first code example appeared in the server message block (SMB) module of WannaCry in 2017, Mydoom in 2009, Joanap, and DeltaAlfa.
Further shared code across these families is an AES library from CodeProject.
These attacks have been attributed to Lazarus; that means the group has reused code from at least 2009 to 2017.
Figure 4:
Code overlap of a Mydoom sample.
In the next screenshots we highlight the exact code block that reflects the SMB module we found in campaigns other than WannaCry and Mydoom.
Figure 5: An SMB module common to several attacks.
A lot has been written about WannaCry.
As we analyze the code against our databases, we can draw the following overview: Figure 6: