
If it is being run in the context of svchost.exe, then it will first start the system service before proceeding with the malicious activities.
If it is being run in the context of rundll32.exe, then it performs the following activities: Deletes the module NTWDBLIB.DLL from the disk using the following command: cmd /c taskkill /im cliconfg.exe /f /t && del /f /q
NTWDBLIB.DLL Sets the code page on the system to 65001, which corresponds to UTF-8: cmd /c REG ADD HKCU\\Console /v
CodePage /t
REG_DWORD /d
65001 /f Command and Control (C2)
Communication SANNY malware uses the FTP protocol as the C2 communication channel.
FTP Config File The FTP configuration information used by SANNY malware is encoded and stored inside ipnet.ini.
This file is Base64 encoded using the following custom character set: SbVIn=BU/dqNP2kWw0oCrm9xaJ3tZX6OpFc7Asi4lvuhf-TjMLRQ5GKeEHYgD1yz8
Upon decoding the file, the following credentials can be recovered: FTP Server: ftp.capnix[.]com Username: cnix_21072852 Password: vlasimir2017 It then continues to perform the connection to the FTP server decoded from the aforementioned config file, and sets the current directory on the FTP server as “htdocs” using the FtpSetCurrentDirectoryW function.
System Information Collection For reconnaissance purposes, SANNY malware executes commands on the system to collect information, which is sent to the C2 server.
System information is gathered from the machine using the following command: The list of running tasks on the system is gathered by executing the following command:
C2 Commands After successful connection to the FTP server decoded from the configuration file, the malware searches for a file containing the substring “to everyone” in the “htdocs” directory.