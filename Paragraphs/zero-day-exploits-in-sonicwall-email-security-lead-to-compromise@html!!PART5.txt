
The system was quickly identified as a SonicWall Email Security (ES) application running on a standard Windows Server 2012 installation.
The adversary-installed web shell was being served through the HTTPS-enabled Apache Tomcat web server bundled with SonicWall ES.
Due to the web shell being served in the applicationâ€™s bundled web server, we immediately suspected the compromise was associated with the SonicWall ES application itself.
When we contacted the customer, we learned that the installation of SonicWall ES was the latest version available for download (10.0.9) and that there was no publicly available information pertaining to vulnerabilities or in-the-wild exploitation.
To determine if a potential application-level vulnerability was exploited to install the web shell, Mandiant collected endpoint telemetry data.
We soon identified post-exploitation activity aimed at destroying evidence on the system, executed in the context of the web shell.