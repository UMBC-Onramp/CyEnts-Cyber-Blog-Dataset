
getting the shell of the server Uploading the public key to vCenter server: captured file upload request Response from vCenter server: response from vCenter server Verifying the public key: verifying the uploaded public key This is how we reach the shell o n the vCenter server.
With this user connected , an attacker can copy any files to the victim machine and execute them.
We can even exploit this vulnerability and use w ebshell as payload.
$ python3 vmwarevcenterserver70-upload.py -u https://192.168.2.143 -f webrce.jsp -t webshell webshell uploaded Verified the user, webshell verified.
Remediation and Conclusion: Juniper Networks’ NGFW SRX customers with an IDP license are protected against compromise of this vulnerability using the signature: HTTP:
CTS:VMWARE-VCENTER-RCE
This signature was released immediately on 26th Feb 2021 with Out-of-Band Export #3359 and is part of the recommended template.
At the same time, those affected by CVE-2021- 21972 should upgrade the vCenter server to the latest version, as advised by the vendor.


