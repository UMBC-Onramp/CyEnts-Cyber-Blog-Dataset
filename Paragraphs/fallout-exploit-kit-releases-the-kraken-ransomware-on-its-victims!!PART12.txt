
Kraken delivered by the exploit kit bypasses the UAC using Event Viewer, drops a file on the system, and executes it through the UAC bypass method.
The binary delivered by the exploit kit.
The authors of the binary forgot during the compilation of the first versions to delete the PDB reference, revealing that the file has a relationship with Kraken Cryptor:
The early versions contained the following path: C:\\Users\\Krypton\\source\\repos\\UAC\\UAC\\obj\\\\Release\\UAC.pdb.
Later versions dropped the PDB path together with the Kraken loader.
Using SysInternals tools One unique feature of this ransomware family is the use of SDelete.
Kraken uses a .bat file to perform certain operations, making file recovery much more challenging: Kraken downloads SDelete from the Sysinternals website, adds the registry key accepting the EULA to avoid the pop-up, and executes it with the following arguments: sdelete.exe -c -z
C The SDelete batch file makes file recovery much harder by overwriting all free space on the drive with zeros, deleting the Volume Shadow Copies, disabling the recovery reboot option and finally rebooting the system after 300 seconds.
Netguid comparison The earlier versions of Kraken were delivered by a loader before it moved to a direct execution method.