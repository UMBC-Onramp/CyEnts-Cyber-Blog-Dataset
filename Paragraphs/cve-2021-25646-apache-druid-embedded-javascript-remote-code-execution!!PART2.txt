
Druid is commonly used by enterprises to analyze real-time or historical data.
It can be deployed as part of public, private or a hybrid cloud.
A code execution vulnerability has been recently reported in Apache Druid that allows a remote unauthenticated user to execute arbitrary javascript code with the privileges of druid server processes.
This vulnerability has been assigned CVE-2021-25646.
More details about CVE-2021-25646 and various affected versions can be found at NVD .
In this blog, let’s take a close look at how this vulnerability works.
Vulnerability Details In our lab, we had Druid version 0.20.0 running on an Ubuntu server.
Druid can ingest data from multiple sources like Apache Kafka, Amazon S3 and Hadoop, among others.
It also allows importing data from the local disk and users can insert their own data while building the data store.
Druid data ingest options To enter your own data, choose “ Source type ” as “ inline “ and simply enter some sample data in JSON format like so: {“isRobot”:true,”channel”:”#itsme”,”timestamp”:”2021-2-22T14:12:24.050Z”,”flags”:”sample”,”isUnpatrolled”:false,”page”:”1″,”diffUrl”:”https://google.com”,”added”:1,”comment”:”I am sample data”,”commentLength”:16,”isNew”:true,”isMinor”:false,”delta”:31,”isAnonymous”:true,”user”:”Lsjbot”, “deltaBucket”:0,”deleted”:0,”namespace”:”Main”} Sample JSON data Here is how the API request looks for this step: Sampler API For other options, you can refer to this Druid quickstart guide that provides simple steps to get you started.