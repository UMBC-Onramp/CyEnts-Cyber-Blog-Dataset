
DGA domains encode either the userID or the list of services The mode values are written into the backdoor configuration key ReportWatcherRetry .
Investigators may consider recovering the malware configuration and inspecting this configuration value to determine the last running mode of the malware.
The following transitions govern how IP block ranges are translated into running modes: Transition Name Description Atm Transition to Truncate Ipx Transition from Append to New ImpLink Transition to Truncate NetBios Transition to Append, either start or continue C2 beaconing Unknown Not an IPv4 or IPv6 address, exit and retry DGA later The following diagram describes how the SUNBURSTâ€™s DGA DNS responses act as mode transitions to control the malware before HTTP-based C2 beaconing has even begun: Additionally, here is an annotated network log showing how a sequence of DNS resolutions can transition the malware mode: To end this discussion of modes and transitions, a small note about the choices of these IP blocks.