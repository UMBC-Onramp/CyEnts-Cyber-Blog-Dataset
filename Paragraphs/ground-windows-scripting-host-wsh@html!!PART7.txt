
This can help bypass application whitelisting and host-based intrusion prevention systems tuned to detect or block such activity.
In this specific case, the attacker used network traffic generated by the malicious script to access legitimate, commonly-used web sites via HTTP.
This traffic would blend into the normal \"noise\" of an enterprise network and evade detection.
One way to detect this form of persistence is to use an IOC that examines files within the Startup folder for references to the WSH.
Investigators should examine each LNK file that this IOC identifies to determine whether the WSH is being used to launch a script; investigators should also analyze all scripts for malicious functions and network indicators.
Here is an example IOC: Network detection is a little trickier because an attacker could implement network communication in a multitude of ways, depending on the purpose of the script, the scripting language and the protocol.
For the example we referenced, the URL parameters \"?action=get&mt=\" might make a good network indicator; here's an example SNORT signature to identify those parameters: Subscribe to Blogs Get email updates as new blog posts are added.


