
Figure 2: Sample document written in English Macro Analysis In both documents, an embedded macro stores the malicious command line to be executed in the TextBox property (TextBox1.Text) of the document.
This TextBox property is first accessed by the macro to execute the command on the system and is then overwritten to delete evidence of the command line.
Stage 1: BAT File Download In Stage 1, the macro leverages the legitimate Microsoft Windows certutil.exe utility to download an encoded Windows Batch (BAT) file from the following URL: http://more.1apps[.]com/1.txt.
The macro then decodes the encoded file and drops it in the %temp% directory with the name: 1.bat.