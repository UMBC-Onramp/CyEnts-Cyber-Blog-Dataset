
The variant we captured uses FTP protocol’s STOR command (store) to submit the stolen sensitive data.
Agent Tesla has several magic flags to identify what kind of the data is being reported.
These are “PW_” for credentials, “CO_” for cookies files, “KL” for keylogger and clipboard, and “SC_” for screenshot (not enabled in this variant).
The data file name consists of a magic flag, User Name, Computer Name, and current time.
Figure 6.1 shows a screenshot of Wireshark displaying the data transportation process in an FTP-Data packet (with the magic flag “PW_”), where it contains stolen credentials saved in Firefox and FileZilla.