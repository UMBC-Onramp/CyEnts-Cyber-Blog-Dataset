
Link File Name: GoogleUpdate.lnk Trigger code for executing the second stage binary and establishing persistence LNK file configuration for establishing persistence Once the second stage payload has been launched, the VBA Macro proceeds to display a decoy document to the end user.
This decoy document is also stored in the VBA Macro as an encrypted string array (similar to the second stage payload).
The decoy document is again written to the user’s temp directory to the following filename/path: <temp_dir_path>\\.\\Job Description.doc Decoy Document decoded in memory by the VBA Macro
Once the decoy document has been written to disk, the VBA Macro sets its file attributes to System + Hidden The decoy document is then opened by the malicious VBA Macro and the original malicious document’s caption is copied over to the decoy document to trick the end user into mistaking the decoy document for the original (malicious) document.
This activity, combined with the fact that the VBA Macro then closes the current (malicious) document, indicates that the VBA Macro aims to trick an unsuspecting user into thinking that the decoy document currently open is the original (malicious) document opened by the user.