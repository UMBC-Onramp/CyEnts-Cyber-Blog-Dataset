
%Temp%\\rtbdxsdcb.js
Going through the JS code we find that its code is highly obfuscated.
According to my analysis, its major task is to request the URL: hxxps[:]//cdn[.]discordapp[.]com/attachments/789415918744764447/857131714521202688/blessed[.]exe This downloads an executable file into %Temp% and saves it as erbxcb.exe, which is the payload file of this malware.
Later, it creates a WScript.
Shell object to start up the payload executable file on the infected device.
Stage I – Starting the Payload Executable File
The payload file, erbxcb.exe, is disguised as a PDF document to confuse the victim.
Figure 2.1 shows what this file looks like.
Once it starts, erbxcb.exe loads a block of compressed data from its PE file and decompresses it into a local file named %Temp%\\arwtfgxjpx80.
(This is an encrypted PE file that I will discuss shortly.)
It continues to dynamically extract a piece of code into the Stack memory and get it executed.
The Extracted Code Mainly Performs: 1.
It copies erbxcb.exe into a newly-created folder (%AppData%\\bplg) and renames “aoqn.exe”.
As you can see in Figure 2.2, it was about to call a function (call 12F675, whose arguments are the source file and the target file) to copy this executable file into a new location.