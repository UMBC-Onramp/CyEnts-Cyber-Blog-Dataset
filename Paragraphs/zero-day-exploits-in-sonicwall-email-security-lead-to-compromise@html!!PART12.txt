
GET /dload_apps?action=REDACTED&path=..%2Fmulti_accounts.xml&id=update GET /dload_apps?action=REDACTED&path=..
%2Fmulti_ldap.xml&id=update Figure 7: HTTP GET requests exploiting CVE-2021-20023
These files contained details about existing accounts as well as Active Directory credentials used by the application.
Next, the adversary uploaded a ZIP archive containing the BEHINDER JSP web shell from the administrative panel's \"branding\" page.
The crafted ZIP archive used a Zip Slip attack to exploit CVE-2021-20022, which caused the web shell to be written to the web-accessible Apache Tomcat directory <SonicWall ES
install path>\\Apache
Software Foundation\\Tomcat 9.0\\webapps\\SearchEngineRMIService\\ .
BEHINDER is a publicly available, multi-platform web shell that accepts encrypted command and control (C2) communications.
In principle, BEHINDER operates similarly to CHINA CHOPPER , a popular web shell that has been previously detailed by FireEye.
Like CHINA CHOPPER, an adversary operates a client-side application to pass commands to the web shell within the body of HTTP requests.
As the core functionality of the backdoor is contained within the client-side application, BEHINDER—much like CHINA CHOPPER—has the added benefit of being small, with the variant observed in this investigation weighing in at less than 1 kilobyte (Figure 8).