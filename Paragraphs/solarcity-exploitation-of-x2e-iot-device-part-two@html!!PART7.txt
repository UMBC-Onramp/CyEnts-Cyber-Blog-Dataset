
By using the datasheet for the flash and then querying the ONFI Device ID of our chip, we determined our chip was utilizing the 8-bit configuration, meaning eight I/O lines were present between the NAND flash and the MCU.
For this attack, we focused on manipulating the power on the first ( I/O0 ) data line.
Figure 2 shows the configuration of the BGA-63 pins, with I/O0 highlighted.
Figure 2: Identifying I/O0 for NAND chip in the Spansion datasheet
Because the pins are actually underneath the flash package, we needed to find an exposed lead that corresponded to I/O0 elsewhere on the PCB.
One such method for tracing connections across a PCB is a continuity test.
A continuity test (using a multimeter) sends a low current electrical signal across two points and produces an audible beep if the points are connected.
Using this technique, we located an exposed test point (known as a via) on the bottom of the PCB.
Figure 3 shows the I/O0 pin on the top of the PCB (under the NAND chip), and Figure 4 shows the I/O0 pin exposed on the bottom of the PCB.
Figure 3: I/O0 on top of PCB (under NAND chip) Figure 4: I/O0 on bottom of PCB With exposed access to I/O0 located, we experimented with connecting this pin directly to a known ground ( GND ) pin at various points during the boot process.