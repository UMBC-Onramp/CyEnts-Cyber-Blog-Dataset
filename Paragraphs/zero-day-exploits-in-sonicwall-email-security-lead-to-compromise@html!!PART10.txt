
CVE-2021-20023 Directory-traversal leads to arbitrary file read in post-authenticated \"branding\" feature Mandiant confirmed another post-authentication vulnerability in the administrative panelâ€™s built-in \"branding\" feature which allowed an adversary to retrieve arbitrary files from the host by sending crafted HTTP GET requests to a particular resource.
Figure 6 demonstrates the formatting of such request.
https://<SonicWall ES host>/dload_apps?action=<any value>&path=..
%2F..
%2F..
%2F
..%2F..%2Fwindows%2Fsystem32%2Fcalc.exe&id=update Figure 6:
An example web request which results in downloading the Windows calculator While the working directory of this branding feature is <SonicWall ES install path>\\data\\updates , a directory-traversal vulnerability allows an adversary to access files located outside of this directory.
As the Apache Tomcat webserver handling this request is operating as the NT AUTHORITY\\SYSTEM account, any file on the operating system can be accessed.
Combinations of all three exploits were leveraged interchangeably by the adversary to perform the following actions: Creation of a new Administrator account on the SonicWall ES device Exposure of the hashed passwords for existing, locally configured Administrative accounts The creation of a web shell in an arbitrary directory Real-time debugging of exploitation success and