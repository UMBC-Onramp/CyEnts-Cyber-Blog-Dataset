
2.
It adds the copied file into the auto-run group in the system registry.
To do this, it calls several APIs, like RegOpenKeyExW() and RegSetValueExW().
Figure 2.3 is a screenshot of the system registry with the added auto-run item, making this malware able to run at Windows startup.
3.
It then loads the decompressed file %Temp%\\ arwtfgxjpx80, mentioned earlier, into memory and calls a function to decrypt it.
As a result, it is able to  extract an executable PE file in memory.
The dynamic code then creates a duplicate of the current process (erbxcb.exe) in a suspended state (by calling the API CreateProcessW() with a CREATE_SUSPENDED flag).
In this way it is able to deploy the decrypted PE file into the newly-created second process.
It then transports each section of the decrypted PE file into the second process to override its existing code.