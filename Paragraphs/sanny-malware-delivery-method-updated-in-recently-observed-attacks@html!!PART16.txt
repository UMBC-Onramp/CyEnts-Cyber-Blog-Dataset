
Bypass NTWDBLIB.dll – This component from the CAB file will be extracted to the %windir%\\system32 directory.
After this, the cliconfg command is executed by the BAT file.
The purpose of this DLL module is to launch the install.bat file.
The file cliconfg.exe is a legitimate Windows binary (SQL Client Configuration Utility), loads the library NTWDBLIB.dll upon execution.
Placing a malicious copy of NTWDBLIB.dll in the same directory as cliconfg.exe is a technique known as DLL side-loading, and results in a UAC bypass.
Execution on Windows 10 and UAC Bypass Update.dll – This component from the CAB file is used to perform UAC bypass on Windows 10.
As described in the BAT File Analysis section, if the underlying operating system is Windows 10, then it uses update.dll to begin the execution of code instead of invoking the install.bat file directly.
The main actions performed by update.dll are as follows:
Executes the following commands to setup the Windows registry for UAC bypass: Leverages a UAC bypass technique that uses the legitimate Windows binary, fodhelper.exe, to perform the UAC bypass on Windows 10 so that the install.bat file is executed with elevated privileges: Creates an additional BAT file, kill.bat, in the current directory to delete evidence of the UAC bypass.