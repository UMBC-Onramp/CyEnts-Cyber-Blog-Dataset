
LOCALAPPDATA%/[8 CHARACTERS].EXE Example filename: %
LOCALAPPDATA%\\lwftkkea.exe
It’s important to note that the process will first check itself in the startup registry key, so a compromised endpoint will have the following registry populated with the executable: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run
Exfiltration/Communication
The malware uses various encryption techniques to communicate with the command and control (C2) nodes.
The communication uses an RSA (i.e. PROV_RSA_FULL) encrypted SSL session using the Microsoft Base Cryptographic Provider while the payloads themselves are RC4 encrypted.
Each sample uses a default hardcoded public key shown below.
Default Public Key -----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCUAUdLJ1rmxx+bAndp+Cz6+5I' Kmgap2hn2df/UiVglAvvg2US9qbk65ixqw3dGN/9O9B30q5RD+xtZ6gl4ChBquqw jwxzGTVqJeexn5RHjtFR9lmJMYIwzoc/kMG8e6C/GaS2FCgY8oBpcESVyT2woV7U 00SNFZ88nyVv33z9+wIDAQAB -----END
PUBLIC KEY-----
First Communication Packet Bot ID RC4 Encrypted URL POST /5DBA62A2529A51B506D197253469FA745E7634B4FC
HTTP/1.1 Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: <host useragent> Host: <host ip>:443 Content-Length: 319 Cache-Control: no-cache <knock><id>5DBA62A247BC1F72B98B545736DEA65A</id><group>0206s</group><src>3</src><transport>0</transport><time>1881051166</time><version>1537</version><status>0</status><debug>none<debug></knock>
C2 Commands
In comparison to the campaign at the end of 2013, the current campaign uses one of the newer versions of the Asprox family where threat actors added the command “ear.”