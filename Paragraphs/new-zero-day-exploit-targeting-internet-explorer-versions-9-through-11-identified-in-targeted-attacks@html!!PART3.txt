
 It allocates Flash vector objects to spray memory and cover address 0x18184000 .
Next, it allocates a vector object that contains a flash.
Media.
Sound() object, which it later corrupts to pivot control to its ROP chain.
•
Arbitrary memory access The SWF file calls back to Javascript in IE to trigger the IE bug and overwrite the length field of a Flash vector object in the heapspray.
The SWF file loops through the heapspray to find the corrupted vector object, and uses it to again modify the length of another vector object.
This other corrupted vector object is then used for subsequent memory accesses, which it then uses to bypass ASLR and DEP.
•
Runtime ROP generation With full memory control, the exploit will search for ZwProtectVirtualMemory , and a stack pivot (opcode 0x94 0xc3) from NTDLL.