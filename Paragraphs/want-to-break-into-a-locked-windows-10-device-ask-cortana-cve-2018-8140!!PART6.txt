
We now have a contextual menu, displayed on a locked Windows 10 device.
What could go wrong?
Remember that all the results presented by Cortana come from indexed files and applications, and that for some applications the content of the file is also indexed.
Now we can simply hover over any of the relevant matches.
If the match is driven by filename matching, then you will be presented with the full path of the file.
If the match is driven by the file content matching, then you may be presented with the content of the file itself.
Keep in mind that the entire user folder structure is indexed, which includes the default location for most documents but also for mappings like OneDrive.
Example of data leakage using voice command with Cortana and the whitespace keyboard sequence.
Armed with this knowledge, you can use your imagination to come up with specific keywords that could be used to start harvesting confidential information from the locked device.
Code Execution from the Windows Lock Screen (User Interaction May be Required)
Next, we asked the question: Could we go a step further and get code execution in the context of the authenticated user?
Remember we are using only a combination of voice commands and mouse/touchpad/touchscreen to gain access to the contextual menu at this point.