
Malicious BAT file stored as an encoded file to appear as an SSL certificate BAT File Analysis Once decoded and executed, the BAT file from Stage 1 will download an encoded CAB file from the base URL: hxxp://more.1apps[.]com/. The exact file name downloaded is based on the architecture of the operating system.
For a 32-bit operating system: hxxp://more.1apps[.]com/2.txt For a 64-bit operating system: hxxp://more.1apps[.]com/3.txt Similarly, based on Windows operating system version and architecture, the CAB file is installed using different techniques.
For Windows 10, the BAT file uses rundll32 to invoke the appropriate function from update.dll (component inside setup.cab).
For a 32-bit operating system: rundll32 update.dll _EntryPoint@16
For a 64-bit operating system: rundll32 update.dll EntryPoint
For other versions of Windows, the CAB file is extracted using the legitimate Windows Update Standalone Installer (wusa.exe) directly into the system directory: The BAT file also checks for the presence of Kaspersky Lab Antivirus software on the machine.
If found, CAB installation is changed accordingly in an attempt to bypass detection: Stage 2: CAB File Analysis As described in the previous section, the BAT file will download the CAB file based on the architecture of the underlying operating system.