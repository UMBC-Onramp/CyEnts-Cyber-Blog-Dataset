
Figure 12: Dumping the unpacked PE If you are dumping a PE that has already been loaded in memory, it will not have the same layout as it does on disk due to differences in section alignment.
As a result, the dumped PE's headers may need to be modified.
One approach is to modify each section's PointerToRawData value to match its VirtualAddress field.