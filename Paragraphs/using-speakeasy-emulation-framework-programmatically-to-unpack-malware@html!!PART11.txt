
and flProtect ==
PAGE_EXECUTE_READWRITE: 14:        self.logger.debug(\"[*] unpack stub VirtualAlloc call, saving dump info\") 15:        self.dump_addr =
rv 16:        self.dump_size = dwSize 17:    return rv Figure 8: VirtualAlloc hook to save memory dump information The hook in Figure 8 calls Speakeasy’s API handler for VirtualAlloc on line 12 to allow memory to be allocated.
The virtual address returned by the API handler is saved to a variable named rv .
Since VirtualAlloc may be used to allocate memory not related to the unpacking process, additional checks are used on line 13 to confirm the intercepted VirtualAlloc call is the one used in the unpacking code.