
Any user with web access to vCenter server can make use of the analytics endpoints to create arbitrary files at any directory of their choice.
A remote unauthenticated user can create a specially crafted request with malicious code embedded in it that can lead to directory traversal and remote code execution.
As an example, following curl request can create a file “ _c_itest.json” with content “ Example” in location “ /var/log/vmware/analytics/prod/” : curl -kv “https://<vCenter-Server-ip>/analytics/telemetry/ph/api/hyper/send?_c&_i=test”
-d “Example” -H “Content-Type: application/json” S teps to recreate attack scenario Create a directory with a test file.
Testing creation of directory and file File 1234.json created As we can see filename “ 1234.json” is created inside folder “ _ c_i” .