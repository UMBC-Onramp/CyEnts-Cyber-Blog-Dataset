
The dropper would save its current location on disk in the default registry value under the HK[LM|CU]:\\Software\\Classes key.
The backdoor spawns a dedicated thread that retrieves the dropper’s path and then proceeds to overwrite the image on disk with 0x00, 0xFF, and a randomly generated byte before deleting the dropper from the file system.
Additionally, the early instance of the backdoor, as mentioned, would not handle the situations when an elevated PowerShell process is used.
The dropper would use a scheduled task in that case with the relevant registry keys created under the HKLM hive but the backdoor does not support that case and will not be able to find its image under the specific key in order to inject itself into the msiexec.exe process.
Finally, the backdoor would output debug information in a few cases using the OutputDebugString API.
Interestingly, the format and the generation of the log message is the same as the one used in the publicly available PEGASUS code ( preliminary technical analysis: Pegasus Malware Source Code ).
The PEGASUS backdoor is distributed with modules that allow it to manipulate files generated by common Russian payment processing software that is used to assess and process VAT refunds.
When executed on a workstation running targeted software, the malware can attempt to add VAT to transactions that are normally exempt and directs associated tax refunds to attacker-controlled bank accounts.
Conclusion Considerable resources were employed by UNC2529 to conduct their December phishing campaign.
Almost 50 domains supported various phases of the effort, targets were researched, and a legitimate third-party domain was compromised.