
And if a domain controller account with the name exists, a service ticket will be granted to the requesting user, making the requesting user a domain administrator.
Combining the Vulnerabilities To exploit this issue, an attacker needs the ability to control a computer account.
As mentioned, the attacker needs to be able to modify both the “servicePrincipalName” attribute and “sAMAccountName” attribute.
The simplest way to achieve this is to create one.
The default configuration in a domain allows an unprivileged user to create up to 10 computer accounts.
This is controlled by the MachineAccountQuota attribute.
In summary, the steps to exploit these vulnerabilities to gain domain-administrator privileges are as follows: 1.
Enumerate the Active-Directory to find a domain administrator account.
2.
Create a new computer account with cleared “servicePrincipalName”.