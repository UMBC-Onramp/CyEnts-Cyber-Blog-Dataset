
Additionally, the adversary obtained in-memory sensitive credentials through the use of built-in memory dumping techniques.
The adversary was observed invoking the MiniDump export of the Windows DLL comsvcs.dll to dump both the process memory for lsass.exe and the running instance of Apache Tomcat as seen in Figure 9.
rundll32.exe C:\\windows\\system32\\comsvcs.dll, MiniDump <lsass PID> c:\\windows\\temp\\TS_LAS.dmp full rundll32.exe C:\\windows\\system32\\comsvcs.dll MiniDump <Tomcat PID> C:\\windows\\temp\\TS_FF9DG.dmp full Figure 9:
The adversary acquiring process memory for lsass.exe (MITRE ATT&CK T1003.001) and Apache Tomcat Mandiant typically observes adversaries employing short and easy-to-type filenames during their operations, simply for efficiency.
As such, the aforementioned filenames initially stood out as being peculiar, as a mix of case and symbols would require more effort to type than is often necessary.
While this could always be indicative of a tool being used, the slight variations between the two commands—the absence of a comma before the DLL export and the uppercase C:\\ drive in the second—suggest that they were manually typed.
Considering that the C:\\Windows\\Temp\\ directory on a Windows host also normally contains numerous similarly named temporary files, the adversary was likely taking extra care to evade suspicion should the activity reach the screen of a security analyst.
Continuing their effort to live off the land as much as possible, the adversary located a copy of the archiving utility 7-Zip already present on the host and used it to compress a subdirectory of <SonicWall ES install path>\\data\\archive\\ .