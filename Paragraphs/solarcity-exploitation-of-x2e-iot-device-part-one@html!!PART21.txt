
Figure 13:
Spansion NAND in BGA clamshell adapter Figure 14: NAND adapter connected to XGecu Using the XGecu Pro software, we can read the entire contents of the flash to a binary file for further analysis.
Since these are not commercial solutions, it is a good idea to perform two or three reads and then diff the extraction to confirm the content was read without errors.
Firmware Analysis Cleaning and Mounting With our fresh NAND dump in hand, the next step was to parse out any relevant firmware blobs, configurations, or filesystems.
The go-to tool for starting this process is binwalk .
binwalk does a fantastic job of detecting filesystems, bootloaders, and kernels.
In addition, binwalk can calculate entropy (detecting packed or encrypted data) and identify assembly opcodes.
Figure 15 shows partial output of running binwalk against the NAND dump.
Figure 15:
Initial binwalk scan against NAND dump We can see from the output that binwalk successfully identified what it believes are U-Boot uImage headers, Linux kernel images, and more than a dozen Journaling Flash File System version 2 (JFFS2) filesystems.