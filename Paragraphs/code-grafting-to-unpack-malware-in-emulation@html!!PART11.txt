
Figure 12: Running to the end of the unpacker and preparing to view the result Figure 13 shows that there was indeed an IMAGE_DOS_SIGNATURE (“MZ”) at this location.
I used idc.get_bytes() to dump the unpacked binary from the fake heap location and saved it for analysis.
Figure 13: Dumping the unpacked binary Through Bochs IDB mode, I was also able to use the interactive debugger interface of IDA Pro to experiment with manipulating execution and traversing a different branch to unpack another payload for this malware as well.