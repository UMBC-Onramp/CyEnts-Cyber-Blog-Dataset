
Vulnerability Discovery
The security vulnerability occurs in the Pluggable Authentication Modules (PAM) library.
PAM enables a Solaris application to authenticate users while allowing the system administrator to configure authentication parameters (e.g., password complexity and expiration) in one location that is consistently enforced by all applications.
The actual vulnerability is a classic stack-based buffer overflow located in the PAM parse_user_name function .
An abbreviated version of this function is shown in Figure 1.
static int parse_user_name(char *user_input, char **ret_username) { register char *ptr; register int index = 0; char username[PAM_MAX_RESP_SIZE]; /* ... */ ptr = user_input; /* ...
*/ /* * username will be the first string we get from user_input * - we skip leading whitespaces and ignore trailing whitespaces */ while (*ptr != '
\\0') { if ((*ptr == ' ')
||
(*ptr == '
\\t')) break; else { username[index] =
*ptr; index++; ptr++; } } /* ret_username will be freed in pam_get_user().