
The ID field contains a unique value generated by the backdoor for the target system.
The UUID field may contain a unique value used to track command output or be empty.
When the C2 server responds with a command to execute, it sets the UUID field to a unique value.
SMOKEDHAM then sets the same UUID value in the subsequent HTTP POST request that contains the command output.
The Data field may contain RC4-encrypted, Base64-encoded command data or be empty.
The backdoor uses the Data field to send command output to its C2 server.
The C2 server uses the Data field to send commands to the backdoor to execute.
The backdoor uses an RC4 key configured by an earlier stage of execution to encrypt and decrypt the Data field.
Mandiant observed the RC4 key UwOdHsFXjdCOIrjTCfnblwEZ used for RC4 encryption and decryption.
SMOKEDHAM Commands SMOKEDHAM Base64-decodes, and RC4-decrypts command data returned in the Data field.
The backdoor checks if the plaintext command data begins with one of the following keywords, shown in Table 1.