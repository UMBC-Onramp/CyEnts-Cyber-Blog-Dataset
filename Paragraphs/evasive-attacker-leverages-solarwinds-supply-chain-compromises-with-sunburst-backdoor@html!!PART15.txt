
This hash value is calculated as the standard FNV-1A 64-bit hash with an additional XOR by 6605813339339102567 after computing the FNV-1A. This hash matches a process named \"solarwinds.businesslayerhost\".
The sample only executes if the filesystem write time of the assembly is at least 12 to 14 days prior to the current time; the exact threshold is selected randomly from an interval.
The sample continues to check this time threshold as it is run by a legitimate recurring background task.
Once the threshold is met, the sample creates the named pipe 583da945-62af-10e8-4902-a8f205c72b2e to act as a guard that only one instance is running before reading SolarWinds.Orion.Core.BusinessLayer.dll.config from disk and retrieving the XML field appSettings.
The appSettings fieldsâ€™ keys are legitimate values that the malicious logic re-purposes as a persistent configuration.
The key ReportWatcherRetry must be any value other than 3 for the sample to continue execution.
The sample checks that the machine is domain joined and retrieves the domain name before execution continues.
A userID is generated by computing the MD5 of a network interface MAC address that is up and not a loopback device, the domain name, and the registry value HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid.
The userID is encoded via a custom XOR scheme after the MD5 is calculated.
The ReportWatcherPostpone key of appSettings is then read from SolarWinds.Orion.Core.BusinessLayer.dll.config to retrieve the initial, legitimate value.
This operation is performed as the sample later bit packs flags into this field and the initial value must be known in order to read out the bit flags.