
Create a new process with explorer.exe access token default command Execute a program on the machine using WinExec() Compression and Encoding Data SANNY malware uses an interesting mechanism for compressing the contents of data collected from the system and encoding it before exfiltration.
Instead of using an archiving utility, the malware leverages Shell.
Application COM object and calls the CopyHere method of the IShellDispatch interface to perform compression as follows: Creates an empty ZIP file with the name: temp.zip in the %temp% directory.
Writes the first 16 bytes of the PK header to the ZIP file.
Calls the CopyHere method of IShellDispatch interface to compress the collected data and write to temp.zip.