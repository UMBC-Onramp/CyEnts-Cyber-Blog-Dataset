
Acknowledgements David Wong, Brandon Walters, Stephen Eckels and Jon Erickson Indicators of Compromise (IOCs)
DEWMODE Web Shells MD5 SHA256 2798c0e836b907e8224520e7e6e4bb42 5fa2b9546770241da7305356d6427847598288290866837626f621d794692c1b bdfd11b1b092b7c61ce5f02ffc5ad55a 2e0df09fa37eabcae645302d9865913b818ee0993199a6d904728f3093ff48c7 UNC2546 Source IP Addresses
The following source IP addresses were observed in multiple UNC2546 intrusions: 45.135.229.179
79.141.162.82 155.94.160.40 192.154.253.120 192.52.167.101 194.88.104.24 Detections FireEye Detections FE_Webshell_PHP_DEWMODE_1 FEC_Webshell_PHP_DEWMODE_1 Webshell.
PHP.DEWMODE Mandiant Security Validation A101-515 Malicious File Transfer - DEWMODE Webshell, Upload, Variant #1 A101-516 Malicious File Transfer - DEWMODE Webshell, Upload, Variant #2
DEWMODE YARA Rule
The following YARA rule is not intended to be used on production systems or to inform blocking rules without first being validated through an organization's own internal testing processes to ensure appropriate performance and limit the risk of false positives.
This rule is intended to serve as a starting point for hunting efforts to identify DEWMODE payloads; however, it may need adjustment over time if the malware family changes.
rule DEWMODE_PHP_Webshell { strings: $s1 = /if
\\(isset\\(\\$_REQUEST\\[[\\x22\\x27]dwn[\\x22\\x27]]\\)[\\x09\\x20]{0,32}&&[\\x09\\x20]{0,32}isset\\(\\$_REQUEST\\[[\\x22\\x27]fn[\\x22\\x27]\\]\\)\\)\\s{0,256}\\{/ $s2 = \"<th>file_id</th>\" $s3 = \"<th>path</th>\" $s4 =
\"<th>file_name</th>\" $s5 = \"<th>uploaded_by</th>\" $s6 = \"target=\\\\\\\"_blank\\\\\\\">Download</a></td>\" $s7 = \"Content-Type: application/octet-stream\" $s8 = \"Content-disposition: attachment; filename=\" condition: all of them } Subscribe to Blogs Get email updates as new blog posts are added.


