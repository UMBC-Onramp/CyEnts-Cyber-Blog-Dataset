
Upon opening the malicious DOC attachment, an additional download is triggered from a stored URL within an embedded OLE Object (seen in Figure 4).
Figure 4: Embedded URL in OLE object Figure 5: HTTP GET request to download the next level payload The downloaded file, doc.doc, is XML-based and contains a PowerShell command (shown in Figure 6) that subsequently downloads the binary Pause.ps1 .
Figure 6: PowerShell command to download the Pause.ps1 payload Dynamic Data Exchange (DDE) Dynamic Data Exchange (DDE) is the interprocess communication mechanism that is exploited to perform remote code execution.
With the help of a PowerShell script (shown in Figure 7), the next payload ( Pause.ps1) is downloaded.
Figure 7: DDE technique used to download the Pause.ps1 payload One of the unique approaches we have observed is the use of dot-less IP addresses (example: hxxp://258476380).
Figure 8 shows the network communication of the Pause.ps1 download.
Figure 8:
Network communication to download the Pause.ps1 payload Zyklon Delivery In all these techniques, the same domain is used to download the next level payload ( Pause.ps1 ), which is another PowerShell script that is Base64 encoded (as seen in Figure 8).
The Pause.ps1 script is responsible for resolving the APIs required for code injection.
It also contains the injectable shellcode.