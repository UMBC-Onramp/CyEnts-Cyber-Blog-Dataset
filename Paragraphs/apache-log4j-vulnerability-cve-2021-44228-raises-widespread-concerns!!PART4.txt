
There are dozens of headers that are typically logged.
We provide below a list of headers that we have already seen used in exploit attempts in the wild.
For this attack to be complete, the attacker needs to host an “LDAP” server (which doesn’t have to be a real LDAP server at all) that will respond with the second stage payload of the attack.
The response to the JNDI request will be used to build the location of the object at: http://myserver.com/payload2.class
At this point, Log4j will fetch and run payload2.class in the server’s process, therefore allowing the attacker to execute this arbitrary code with the privileges of the web server’s process.