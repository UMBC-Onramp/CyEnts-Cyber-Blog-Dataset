
Figure 8:
Abbreviated routine for assembling a call instruction and patching a call site to an import The Code Grafting script updated all the relevant call sites to resemble Figure 9, with the target functions being replaced by calls to the stub
_ implementations injected earlier.
This prevented Bochs in IDB mode from getting derailed when hitting these call sites, because the call operands now pointed to valid code inside the IDB.
Figure 9: Patched operator new() call site Dealing with EVILNEST
The debug scenario for the dropper was slightly inconvenient, and simultaneously, it was setting up a very unusual call site for the payload entry point.